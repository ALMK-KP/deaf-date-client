@if (tracks.length) {
  @if (mode === "CREATION") {
    <div class="flex gap-2 justify-between items-center pt-8">
      <h2 class="text-lg font-semibold text-green-500 tracking-widest">
        Your current playlist
      </h2>
      <button
        class="my-1 mx-2 text-center font-bold text-green-500 tracking-widest ring-2 ring-green-500 outline-none focus:ring-4 focus:ring-green-500 hover:ring-4 hover:ring-green-500 p-1"
        (click)="openConfirmationDialog()"
      >
        <img src="assets/icons/icons8-remove-48.png" width="24" height="24" />
      </button>
    </div>
  }
  <ul
    class="pt-2 text-white text-sm gap-2 flex flex-col"
    [class.mt-8]="mode !== 'CREATION'"
  >
    @for (track of tracks; track track.id; let i = $index) {
      <li class="rounded-sm p-2 bg-neutral-600">
        <div class="flex gap-2" (click)="toggleExpanded(track.id)">
          <p>{{ i + 1 }}.</p>
          @if (track.thumbnail) {
            <a
              [href]="track.ytLink"
              target="_blank"
              class="block flex-shrink-0"
            >
              <img [src]="track.thumbnail" alt="" width="50" height="40" />
            </a>
          }
          <div>
            @if (mode !== "ENCODED") {
              <h2>{{ track.title }}</h2>
              <p>{{ track.channelTitle }}</p>
            }
            <p
              [class.italic]="mode === 'DECODED'"
              [class.text-neutral-300]="mode === 'DECODED'"
              [class.border-t]="mode !== 'ENCODED'"
              [class.pt-2]="mode !== 'ENCODED'"
              [class.mt-2]="mode !== 'ENCODED'"
              [class.border-orange-500]="mode === 'DECODED'"
              [class.border-green-500]="mode !== 'DECODED'"
              class="text-xs"
            >
              {{ track.customTitle }}
            </p>
          </div>
        </div>
        @if (expanded && track.id === expandedTrackId && mode === "CREATION") {
          <app-custom-description-input
            [initialValue]="getInitialValueOfCustomTitle(track.customTitle)"
            [trackId]="track.id"
            (customTitleUpdated)="updateCustomTitle($event)"
          />
        }

        @if (expanded && track.id === expandedTrackId && mode !== "CREATION") {
          <audio
            controls
            class="mt-2 mx-auto"
            autoplay
            controlslist="nofullscreen nodownload noremoteplayback noplaybackrate"
          >
            <source [src]="track.audio" type="audio/mpeg" />
            Your browser does not support the audio element.
          </audio>
        }
      </li>
    }
  </ul>
} @else {
  @if (mode === "CREATION") {
    <p class="text-center italic pt-24 pb-20">No tracks added yet</p>
  } @else {
    <p class="text-center italic pt-24 pb-20">Playlist doesn't exist</p>
  }
  <!--  TODO: fix loading state-->
  <!--  <div class="flex items-center justify-center h-screen">-->
  <!--    <div class="loader"></div>-->
  <!--  </div>-->
}
<p
  class="text-center tracking-widest p-4"
  [class.text-orange-500]="mode === 'DECODED'"
  [class.text-green-500]="mode !== 'DECODED'"
>
  .. ... .. ...
</p>
@if (isConfirmationDialogOpened) {
  <app-dialog
    (emitDialogClicked)="removePlaylist($event)"
    message="Are you sure you want to delete current playlist?"
  />
}
